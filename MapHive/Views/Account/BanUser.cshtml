@using MapHive.Models.Enums
@using MapHive.Models.ViewModels
@model BanUserPageViewModel

<h2>Ban User: @Model.Username</h2>

<p>You are about to ban user <strong>@Model.Username</strong>.</p>
<p>User Tier: <strong>@Model.AccountTier</strong></p>
<!-- Registration IP is no longer displayed directly -->

@if (Model.AccountTier == AccountTier.Admin)
{
    <div class="alert alert-warning" role="alert">
        Cannot ban an administrator.
    </div>
    <a asp-action="PublicProfileById" asp-route-accountId="@Model.AccountId" class="btn btn-secondary">Back to Profile</a>
}
else
{
    <form asp-action="Ban" method="post">
        <input type="hidden" name="username" value="@Model.Username" />

        <div asp-validation-summary="ModelOnly" class="text-danger"></div>

        <div class="form-group mb-3">
            <label for="BanType" class="control-label">Ban Type</label>
            <select id="BanType" name="BanType" class="form-control">
                <option value="@MapHive.Models.Enums.BanType.Account">Account Ban</option>
                <option value="@MapHive.Models.Enums.BanType.IpAddress">IP Address Ban</option>
            </select>
        </div>

        <div class="form-group mb-3">
            <label for="Reason" class="control-label">Reason</label>
            <textarea id="Reason" name="Reason" class="form-control" rows="3"></textarea>
        </div>

        <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="IsPermanent" name="IsPermanent" checked="checked" />
            <label class="form-check-label" for="IsPermanent">Permanent Ban</label>
        </div>

        <div class="form-group mb-3" id="banDurationGroup">
            <label for="BanDurationDays" class="control-label">Ban Duration (Days)</label>
            <input id="BanDurationDays" name="BanDurationDays" class="form-control" type="number" min="1" />
        </div>

        <div class="form-group">
            <button type="submit" class="btn btn-danger">Confirm Ban</button>
            <a asp-action="PublicProfileById" asp-route-accountId="@Model.AccountId" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
}

@section Scripts {
    <script>
        $(document).ready(function () {
            function toggleDuration() {
                if ($('#isPermanentCheck').is(':checked')) {
                    $('#banDurationGroup').hide();
                    $('#BanDurationDays').val(''); // Clear value when hiding
                } else {
                    $('#banDurationGroup').show();
                }
            }

            // Initial state
            toggleDuration();

            // Toggle on change
            $('#isPermanentCheck').change(toggleDuration);
        });
    </script>
} 
